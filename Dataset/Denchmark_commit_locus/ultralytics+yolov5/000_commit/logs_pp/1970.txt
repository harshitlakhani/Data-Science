max workers dataloader
rank rank batch size batchsize min batch size batchsize len dataset min cpu count cpucount world size worldsize batch size batchsize batch size batchsize else number workers min cpu count cpucount world size worldsize batch size batchsize batch size batchsize else workers number workers train sampler trainsampler torch utils data distributed distributed sampler distributedsampler dataset rank else none dataloader torch utils data data loader dataloader dataset batch size batchsize batch size batchsize
