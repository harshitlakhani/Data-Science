update ddp torch distributed run gloo backend update ddp torch distributed run add localrank remove opt local rank localrank backend gloo nccl print print debug debug getenv gloo gloo gloo cleanup fix getenv cleanup cleanup destroy try nccl return opt add local rank localrank add timeout add init method initmethod gloo move destroy move destroy move print opt rank destroy rank move destroy inside train restore destroy outside train update print opt cleanup nccl gloo second timeout update namespace printing
opt resume wandb run wandbrun resume interrupted run ckpt opt resume isinstance opt resume str else get latest run getlatestrun specified recent path assert path isfile ckpt error resume checkpoint exist apriori opt global rank globalrank opt local rank localrank open path ckpt parent parent opt yaml opt argparse namespace yaml safe load safeload replace opt cfg opt weights opt resume opt batch size batchsize opt global rank globalrank opt local rank localrank ckpt true opt total batch size totalbatchsize apriori reinstate opt cfg opt weights opt resume opt batch size batchsize ckpt true opt total batch size totalbatchsize reinstate logger info resuming training ckpt else opt hyp opt hyp hyp finetune yaml opt weights else hyp scratch yaml
