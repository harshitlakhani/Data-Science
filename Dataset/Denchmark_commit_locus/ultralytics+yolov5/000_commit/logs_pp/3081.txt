update ddp torch distributed run gloo backend update ddp torch distributed run add localrank remove opt local rank localrank backend gloo nccl print print debug debug getenv gloo gloo gloo cleanup fix getenv cleanup cleanup destroy try nccl return opt add local rank localrank add timeout add init method initmethod gloo move destroy move destroy move print opt rank destroy rank move destroy inside train restore destroy outside train update print opt cleanup nccl gloo second timeout update namespace printing
def create dataloader createdataloader path imgsz batch size batchsize stride single cls singlecls false hyp none augment false cache false pad rect false rank world size worldsize workers image weights imageweights false quad false prefix rect false rank workers image weights imageweights false quad false prefix make sure first process ddp process dataset first following others use cache torch distributed zero first torchdistributedzerofirst rank dataset load images labels loadimagesandlabels path imgsz batch size batchsize
