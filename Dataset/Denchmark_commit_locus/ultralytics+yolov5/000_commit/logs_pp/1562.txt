fuse gradient introduction bug fix
def fuse conv fuseconvandbn conv https tehnokv com posts fusing batchnorm conv fusingbatchnormandconv torch grad nograd init fusedconv convd conv channels inchannels conv channels outchannels kernel size kernelsize conv kernel size kernelsize stride conv stride padding conv padding groups conv groups bias true conv weight device prepare filters conv wconv conv weight clone view conv channels outchannels wbn torch diag weight div torch sqrt eps running var runningvar fusedconv weight copy torch wbn conv wconv view fusedconv weight size prepare spatial bias conv bconv torch zeros conv weight size device conv weight device conv bias none else conv bias bbn bias weight mul running mean runningmean div torch sqrt running var runningvar eps fusedconv bias copy torch wbn conv bconv reshape reshape bbn return fusedconv fuse convolution batchnorm layers https tehnokv com posts fusing batchnorm conv fusingbatchnormandconv init fusedconv convd conv channels inchannels conv channels outchannels kernel size kernelsize conv kernel size kernelsize stride conv stride padding conv padding groups conv groups bias true requires grad requiresgrad false conv weight device prepare filters conv wconv conv weight clone view conv channels outchannels wbn torch diag weight div torch sqrt eps running var runningvar fusedconv weight copy torch wbn conv wconv view fusedconv weight size prepare spatial bias conv bconv torch zeros conv weight size device conv weight device conv bias none else conv bias bbn bias weight mul running mean runningmean div torch sqrt running var runningvar eps fusedconv bias copy torch wbn conv bconv reshape reshape bbn return fusedconv def model info modelinfo model verbose false
