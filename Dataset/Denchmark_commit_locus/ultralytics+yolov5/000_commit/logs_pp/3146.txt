utils reorganization utils reorganization add new utils files cleanup simplify reduce datasets remove evolve load webcam loadwebcam cleanup
return new size newsize def check anchors checkanchors dataset model thr imgsz check anchor fit data recompute necessary print analyzing nanalyzing anchors end model module model hasattr model module else model model detect shapes imgsz dataset shapes dataset shapes max keepdims true scale random uniform size shapes shape augment scale torch tensor concatenate zip shapes scale dataset labels float def metric compute metric none none knone torch min min ratio metric best max best bestx aat thr float sum mean anchors threshold bpr best thr float mean best possible recall return bpr aat bpr aat metric anchor grid anchorgrid clone cpu view print anchors target best possible recall bpr aat bpr end bpr bpr replace anchors new anchors newanchors torch tensor new anchors newanchors device anchors device type typeas anchors anchor grid anchorgrid new anchors newanchors clone view viewas anchor grid anchorgrid inference anchors new anchors newanchors clone view viewas anchors stride anchors device view loss check anchor order checkanchororder print new anchors saved model update model yaml use anchors future else print original anchors better new anchors proceeding original anchors print newline def check anchor order checkanchororder check anchor order stride order yol yolov detect module correct necessary anchor grid anchorgrid prod view anchor area delta stride stride delta sign sign order print reversing anchor order anchors anchors flip anchor grid anchorgrid anchor grid anchorgrid flip def check file checkfile file search file found path isfile file file
