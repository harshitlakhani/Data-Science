wip feature ddp fixed squashed commit following commit decbbcdaaccaebf author nano code nanocode date tue jul adding world size worldsize reduce calls torch distributed use create dataloader createdataloader commit edddcddcddcdc author yizhi chen date tue jul make sync syncbn choice commit edefecadfcbcedce merge bfbeb author yzchen date tue jul merge pull request nano code nanocode patch update train commit cdefbdabadabfeaf author nano code nanocode date tue jul update train remove redundant opt prefix commit bfbebeafbbfefacafac merge author yizhi chen date tue jul merge branch master https github com ultralytics yolov feature ddp fixed ddpfixed commit cabfebbdccaeeffcbb author yizhi chen date tue jul add device allocation loss compute commit fcfbeaeeeefcaeebd author yizhi chen date thu jul revert drop last droplast commit dabeaabccfccab merge aceb author yizhi chen date thu jul merge branch feature ddp fixed ddpfixed https github com magic frog sjtu magicfrogsjtu yolov feature ddp fixed ddpfixed commit acebebdfcbdeebcebee author yizhi chen date thu jul fix warning commit bbdbeecddfdcfbe merge baae cef author yzchen date wed jul merge pull request nano code nanocode patch add drop last droplast multi gpu commit cefcfbbfecceab author nano code nanocode date wed jul add drop last droplast multi gpu commit baaedabfdeaccdf merge ecdcc author yizhi chen date tue jul merge branch master https github com ultralytics yolov feature ddp fixed ddpfixed commit ecdcccdeddffecdfbfbd merge author yizhi chen date tue jul merge branch feature ddp fixed ddpfixed https github com magic frog sjtu magicfrogsjtu yolov feature ddp fixed ddpfixed commit dedfeeeaccccdfebaa author yizhi chen date tue jul add sync syncbn commit abadabbeacbb merge faa author yzchen date tue jul merge pull request nano code nanocode patch convert batch norm batchnorm sync batch norm syncbatchnorm commit baaacdaffbc author nano code nanocode date tue jul add cleanup process group processgroup commit aafccaebededda author nano code nanocode date tue jul remove apex parallel use torch parallel future compatibility commit ceebeaaecaddcd author nano code nanocode date tue jul convert batch norm batchnorm sync batch norm syncbatchnorm commit faaaeffdfeebecadc author yizhi chen date mon jul fix datset inconsistency problem commit ecdcdcdffccfddc author yizhi chen date mon jul add loss multiplication preserver single process singleprocess performance commit effdefabefccc merge bdeaf author yizhi chen date fri jul merge branch master https github com ultralytics yolov feature ddp fixed ddpfixed commit bbfedfeaafdebebc author yizhi chen date thu jul ddp established squashed commit following commit eabddcbdedcf merge acbdc author yizhi chen date thu jul merge branch master https github com ultralytics yolov feature ddp fixed ddpfixed commit acbdcbefcbcbbbabbd author glenn jocher date wed jul update test save txt savetxt commit bcdaadafdb author glenn jocher date wed jul update test save txt savetxt commit efcdbcebeeb author yizhi chen date wed jul revert readme removal commit cbfadcafdc merge cdb fbbb author yizhi chen date wed jul merge branch feature ddp fixed ddpfixed https github com magic frog sjtu magicfrogsjtu yolov feature ddp fixed ddpfixed commit cdbcdcdffbbbadfcece author yizhi chen date wed jul fix ddp performance deterioration bug commit fbbbfaebabbbdfbee author glenn jocher date wed jul delete readme commit fbaefbacbacf merge abf bdfdbb author yizhi chen date wed jul merge branch feature ddp fixed ddpfixed https github com magic frog sjtu magicfrogsjtu yolov feature ddp fixed ddpfixed commit bdfdbbfbefeeffacaae author glenn jocher date tue jul update readme commit caaccbaaafcaefdecec merge bfb author glenn jocher date tue jul merge branch master feature ddp fixed ddpfixed commit bfbfafdfadbda author nano code nanocode date tue jul fixed world size worldsize found called test commit abfcddabadaaacaafbdc merge cad author yizhi chen date tue jul merge branch feature ddp fixed ddpfixed https github com magic frog sjtu magicfrogsjtu yolov feature ddp fixed ddpfixed commit adeddabedfaab author yizhi chen date tue jul add assertion date tue jul merge pull request magic frog sjtu magicfrogsjtu nano code patch nanocodepatch modify number dataloaders workers commit ffefabca author nano code nanocode date tue jul fixed issue single gpu world size worldsize commit daaddfdbfebfeba author nano code nanocode date tue jul add assert message clarification clarify assertion thrown users commit deddefcedafaf author nano code nanocode date tue jul changed number workers check commit decbbcdaaccaebf author nano code nanocode date tue jul adding world size worldsize reduce calls torch distributed use create dataloader createdataloader commit edddcddcddcdc author yizhi chen date tue jul make sync syncbn choice commit edefecadfcbcedce merge bfbeb author yzchen date tue jul merge pull request nano code nanocode patch update train commit cdefbdabadabfeaf author nano code nanocode date tue jul update train remove redundant opt prefix commit bfbebeafbbfefacafac merge author yizhi chen date tue jul merge branch master https github com ultralytics yolov feature ddp fixed ddpfixed commit cabfebbdccaeeffcbb author yizhi chen date tue jul add device allocation loss compute commit fcfbeaeeeefcaeebd author yizhi chen date thu jul revert drop last droplast commit dabeaabccfccab merge aceb author yizhi chen date thu jul merge branch feature ddp fixed ddpfixed https github com magic frog sjtu magicfrogsjtu yolov feature ddp fixed ddpfixed commit acebebdfcbdeebcebee author yizhi chen date thu jul fix warning commit bbdbeecddfdcfbe merge baae cef author yzchen date wed jul merge pull request nano code nanocode patch add drop last droplast multi gpu commit cefcfbbfecceab author nano code nanocode date wed jul add drop last droplast multi gpu commit baaedabfdeaccdf merge ecdcc author yizhi chen date tue jul merge branch master https github com ultralytics yolov feature ddp fixed ddpfixed commit ecdcccdeddffecdfbfbd merge author yizhi chen date tue jul merge branch feature ddp fixed ddpfixed https github com magic frog sjtu magicfrogsjtu yolov feature ddp fixed ddpfixed commit dedfeeeaccccdfebaa author yizhi chen date tue jul add sync syncbn commit abadabbeacbb merge faa author yzchen date tue jul merge pull request nano code nanocode patch convert batch norm batchnorm sync batch norm syncbatchnorm commit baaacdaffbc author nano code nanocode date tue jul add cleanup process group processgroup commit aafccaebededda author nano code nanocode date tue jul remove apex parallel use torch parallel future compatibility commit ceebeaaecaddcd author nano code nanocode date tue jul convert batch norm batchnorm sync batch norm syncbatchnorm commit faaaeffdfeebecadc author yizhi chen date mon jul fix datset inconsistency problem commit ecdcdcdffccfddc author yizhi chen date mon jul add loss multiplication preserver single process singleprocess performance commit effdefabefccc merge bdeaf author yizhi chen date fri jul merge branch master https github com ultralytics yolov feature ddp fixed ddpfixed commit bbfedfeaafdebebc author yizhi chen date thu jul ddp established fixed destroy process group destroyprocessgroup mode update torch utils torchutils update utils revert build targets buildtargets current master update datasets fixed world size worldsize attribute found authored coauthoredby nano code nanocode authored coauthoredby glenn jocher
model names names class frequency labels concatenate dataset labels torch tensor labels classes torch bincount long minlength model initialize biases initializebiases device plot labels plotlabels labels save dir savedir log dir logdir writer tbwriter writer tbwriter add hparams addhparams hyp causes duplicate https github com ultralytics yolov pull writer tbwriter add histogram addhistogram classes check anchors opt noautoanchor check anchors checkanchors dataset model model thr hyp anchor anchort imgsz imgsz exponential moving average ema torch utils torchutils model ema modelema model one check log needed local rank localrank labels concatenate dataset labels torch tensor labels classes torch bincount long minlength model initialize biases initializebiases device plot labels plotlabels labels save dir savedir log dir logdir writer tbwriter writer tbwriter add hparams addhparams hyp causes duplicate https github com ultralytics yolov pull writer tbwriter add histogram addhistogram classes check anchors opt noautoanchor check anchors checkanchors dataset model model thr hyp anchor anchort imgsz imgsz start training time time max number warmup iterations max epochs iterations maps zeros map per class results map val giou val objectness val classification scheduler last epoch lastepoch start epoch startepoch move print image sizes train test imgsz imgsz test imgsztest print using dataloader workers dataloader num workers numworkers print starting training epochs epochs local rank localrank print image sizes train test imgsz imgsz test imgsztest print using dataloader workers dataloader num workers numworkers print starting training epochs epochs torch autograd set detect anomaly setdetectanomaly true epoch range start epoch startepoch epochs epoch model train update image weights optional ddp mode generated indices broadcasted synchronize dataset dataset image weights imageweights model class weights classweights cpu numpy maps class weights image weights imageweights labels image weights labelstoimageweights dataset labels class weights classweights dataset indices random choices range dataset weights image weights imageweights dataset rand weighted idx generate indices local rank localrank model class weights classweights cpu numpy maps class weights image weights imageweights labels image weights labelstoimageweights dataset labels class weights classweights dataset indices random choices range dataset weights image weights imageweights dataset rand weighted idx broadcast local rank localrank indices torch zeros dataset dtype torch int local rank localrank indices torch tensor fromtensor dataset indices dtype torch int dist broadcast indices local rank localrank dataset indices indices cpu numpy update mosaic border int random uniform imgsz imgsz dataset mosaic border mosaicborder imgsz height width borders mloss torch zeros device device mean losses print epoch gpu mem gpumem giou obj cls total targets img size imgsize pbar tqdm enumerate dataloader total progress bar local rank localrank dataloader sampler set epoch setepoch epoch pbar enumerate dataloader local rank localrank print epoch gpu mem gpumem giou obj cls total targets img size imgsize pbar tqdm pbar total progress bar optimizer zero grad zerograd imgs targets paths pbar batch epoch number integrated batches since train start imgs imgs device non blocking nonblocking true float uint float
