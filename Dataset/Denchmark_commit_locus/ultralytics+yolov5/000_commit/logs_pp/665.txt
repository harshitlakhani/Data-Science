simplified inference
import numpy import torch import yaml sotabencheval object detection objectdetection import coco evaluator cocoevaluator sotabencheval utils import server isserver tqdm import tqdm models experimental import attempt load attemptload utils datasets import create dataloader createdataloader utils general import coco coco class cocotocococlass check dataset checkdataset check file checkfile check img size checkimgsize compute loss computeloss non max suppression nonmaxsuppression scale coords scalecoords xyxyxywh clip coords clipcoords plot images plotimages xywhxyxy box iou boxiou output target outputtotarget per class apperclass set logging setlogging xyxyxywh clip coords clipcoords set logging setlogging utils torch utils torchutils import select device selectdevice time synchronized timesynchronized sotabencheval object detection objectdetection import coco evaluator cocoevaluator sotabencheval utils import server isserver dataroot data vision coco server isserver else coco sotabench data dir
