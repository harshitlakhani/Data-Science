replace random affine randomaffine random perspective randomperspective signed signedoffby glenn jocher
return img ratio def random affine randomaffine img targets degrees translate scale shear border def random perspective randomperspective img targets degrees translate scale shear perspective border torchvision transforms random affine randomaffine degrees translate scale shear https medium com uruvideo dataset augmentation random homographies afbd datasetaugmentationwithrandomhomographiesafbd targets cls xyxy height img shape border shape width img shape border center eye img shape translation pixels img shape translation pixels perspective eye random uniform perspective perspective perspective random uniform perspective perspective perspective rotation scale eye random uniform degrees degrees random choice add deg rotations small rotations random uniform scale scale random uniform scale scale get rotation matrix getrotationmatrixd angle center img shape img shape scale translation eye random uniform translate translate img shape border translation pixels random uniform translate translate img shape border translation pixels get rotation matrix getrotationmatrixd angle center scale shear eye math tan random uniform shear shear math shear deg math tan random uniform shear shear math shear deg translation eye random uniform translate translate width translation pixels random uniform translate translate height translation pixels combined rotation matrix order important order operations right left important border border eye image changed img warp affine warpaffine img dsize width height flags interlinear border value bordervalue perspective img warp perspective warpperspective img dsize width height border value bordervalue else affine img warp affine warpaffine img dsize width height border value bordervalue visualize import matplotlib pyplot plt plt subplots figsize ravel imshow img base imshow img warped transform label coordinates len targets
