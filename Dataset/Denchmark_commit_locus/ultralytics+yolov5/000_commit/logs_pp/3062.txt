update ddp torch distributed run gloo backend update ddp torch distributed run add localrank remove opt local rank localrank backend gloo nccl print print debug debug getenv gloo gloo gloo cleanup fix getenv cleanup cleanup destroy try nccl return opt add local rank localrank add timeout add init method initmethod gloo move destroy move destroy move print opt rank destroy rank move destroy inside train restore destroy outside train update print opt cleanup nccl gloo second timeout update namespace printing
utils wandb logging wandblogging wandb utils wandbutils import wandb logger wandblogger check wandb resume checkwandbresume logger logging get logger getlogger name localrank int getenv localrank https pytorch org docs stable elastic run html rank int getenv rank worldsize int getenv worldsize def train hyp path hyp yaml hyp dictionary opt device save dir savedir epochs batch size batchsize total batch size totalbatchsize weights rank single cls singlecls path opt save dir savedir opt epochs opt batch size batchsize opt total batch size totalbatchsize opt weights opt global rank globalrank opt single cls singlecls save dir savedir epochs batch size batchsize total batch size totalbatchsize weights single cls singlecls path opt save dir savedir opt epochs opt batch size batchsize opt total batch size totalbatchsize opt weights opt single cls singlecls directories wdir save dir savedir weights
