simplified inference
class nms module non maximum nonmaximum suppression nms module conf confidence threshold iou iou threshold conf confidence threshold iou iou threshold classes none optional list filter class def init self dimension def init self super nms self init def forward self return non max suppression nonmaxsuppression conf thres confthres self conf iou thres iouthres self iou classes self classes class auto shape autoshape module input robust inputrobust model wrapper passing pil torch inputs includes preprocessing inference nms img size imgsize inference size pixels conf nms confidence threshold iou nms iou threshold classes none optional list filter class def init self model super auto shape autoshape self init self model model def forward self size augment false profile false supports inference various sources height width rgb images example inputs opencv imread image jpg hwc bgr rgb pil image open image jpg hwc numpy zeros hwc torch torch zeros bchw multiple image open image jpg image open image jpg list images next self model parameters device type isinstance torch tensor torch return self model device type typeas augment profile inference pre process preprocess isinstance list shape shape image inference shapes batch range len batch size batch array channels png shape hwc shape append image shape size max gain shape append shape make divisible makedivisible int self stride max stack shape max inference shape letterbox new shape newshape shape auto false batch pad stack batch else none xnone stack ascontiguousarray transpose bhwc bchw torch numpy fromnumpy device type typeas uint inference self model augment profile forward non max suppression nonmaxsuppression conf thres confthres self conf iou thres iouthres self iou classes self classes nms post process postprocess batch none scale coords scalecoords shape shapei return class flatten module use adaptive avg poold adaptiveavgpoold remove last dimensions staticmethod
