display correct cuda devices display correct cuda devices cleanup
cpu request cpurequest device lower cpu device cpu request cpurequest device requested cpu environ cudavisibledevices device set environment variable assert torch cuda available isavailable cuda unavailable invalid device requested device check availablity assert torch cuda available isavailable cuda unavailable invalid device device requested check availablity cuda false cpu request cpurequest else torch cuda available isavailable cuda bytes torch cuda device count devicecount batch size batchsize check batch size batchsize compatible device count devicecount assert batch size batchsize batch size batchsize multiple gpu count batch size batchsize assert batch size batchsize batch size batchsize batch size batchsize multiple gpu count torch cuda get device properties getdeviceproperties range using torch torch version range enumerate device split len logger info cuda scuda dmb name total memory totalmemory logger info cuda name total memory totalmemory else logger info using torch torch version cpu
