improved corruption handling scan cache
raise exception exist self img files imgfiles sorted replace sep path splitext lower img formats imgformats assert len self img files imgfiles images found except exception raise exception error loading data see snsee path help url helpurl len self img files imgfiles assert images found see path help url helpurl floor arange batch size batchsize astype int batch index number batches self number images self batch batch index image self img size imgsize img size imgsize self augment augment self hyp hyp self image weights imageweights image weights imageweights self rect false image weights imageweights else rect self mosaic self augment self rect load images time mosaic training self mosaic border mosaicborder img size imgsize img size imgsize self stride stride check cache self label files labelfiles imglabel paths imglabelpaths self img files imgfiles labels cache path cachepath str path self label files labelfiles parent cache cached labels
