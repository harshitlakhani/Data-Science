label caching foundational write rewrite
self batch shapes batchshapes ceil array shapes img size imgsize stride pad astype int stride cache labels self imgs none self labels zeros dtype float create datasubset createdatasubset extract bounding boxes extractboundingboxes labels loaded labelsloaded false false false number missing found empty datasubset duplicate labels path nplabelspath str path self label files labelfiles parent npy saved labels npy file path isfile labels path nplabelspath labels path nplabelspath print string load labels path nplabelspath allow pickle allowpickle true len self labels labels loaded labelsloaded true else path replace images labels pbar tqdm self label files labelfiles file enumerate pbar labels loaded labelsloaded self labelsi savetxt file save txt npy file else try open file array split read splitlines dtype float except print missing labels image self img filesi imgfilesi file missing continue self labelsi label shape assert shape label columns file assert negative labels file
