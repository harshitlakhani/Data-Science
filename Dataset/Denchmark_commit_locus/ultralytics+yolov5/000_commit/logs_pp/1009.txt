label caching foundational write rewrite
self stride stride define labels self label files labelfiles replace images labels replace path splitext txt self img files imgfiles read image shapes path replace txt shapes shapefile path try open read existing shapefile split read splitlines assert len shapefile sync except exif size exifsize image open tqdm self img files imgfiles desc reading image shapes savetxt fmt overwrites existing self label files labelfiles replace images labels replace path splitext txt self img files imgfiles check cache cache path cachepath str path self label files labelfiles parent cache cached labels path isfile cache path cachepath cache torch load cache path cachepath load cache hash get hash gethash self label files labelfiles self img files imgfiles dataset changed cache self cache labels cachelabels cache path cachepath cache recache else cache self cache labels cachelabels cache path cachepath cache self shapes array dtype float get labels labels shapes zip cachex self img files imgfiles self shapes array shapes dtype float self labels list labels rectangular training https github com ultralytics yolov issues self rect
