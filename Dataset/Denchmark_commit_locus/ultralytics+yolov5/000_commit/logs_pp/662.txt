simplified inference
self info return self def add nms addnms self fuse model convd batch normd batchnormd layers type self model nms missing nms print adding nms module def nms self mode true add remove nms module present type self model nms last layer nms mode present print adding nms nms module self model index self model add module addmodule name module add self eval elif mode present print removing nms self model self model remove return self def autoshape self add auto shape autoshape module print adding auto shape autoshape auto shape autoshape self wrap model copy attr copyattr self include yaml hyp names stride exclude copy attributes return def info self verbose false print model information model info modelinfo self verbose
