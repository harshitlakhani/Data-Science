torch pytorch version screen cleanup create flatten recursive flattenrecursive helper function cleanup print torch version
batch size batchsize check batch size batchsize compatible device count devicecount assert batch size batchsize batch size batchsize multiple gpu count batch size batchsize torch cuda get device properties getdeviceproperties range using cuda using torch torch version range len logger info sdeviceg cuda device properties cudadeviceproperties name total memory totalmemory dmb name total memory totalmemory logger info cuda scuda dmb name total memory totalmemory else logger info using cpu logger info using torch torch version cpu logger info skip line return torch device cuda cuda else cpu
