refactor dataloader
return def create dataloader createdataloader path imgsz batch size batchsize stride opt hyp none augment false cache false pad rect false dataset load images labels loadimagesandlabels path imgsz batch size batchsize augment augment augment images hyp hyp augmentation hyperparameters rect rect rectangular training cache images cacheimages cache single cls singlecls opt single cls singlecls stride stride pad pad batch size batchsize min batch size batchsize len dataset min cpu count cpucount batch size batchsize batch size batchsize else number workers dataloader torch utils data data loader dataloader dataset batch size batchsize batch size batchsize num workers numworkers pin memory pinmemory true collate collatefn load images labels loadimagesandlabels collate collatefn return dataloader dataset class load images loadimages inference def init self path img size imgsize path str path path agnostic osagnostic
