auto shape autoshape default torch pytorch hub models add autoshape parameter remove autoshape call read readme update hubconf file uri inputs autoshape check passthrough authored coauthoredby glenn jocher
super auto shape autoshape self init self model model eval def autoshape self print auto shape autoshape already enabled skipping model already converted model autoshape return self def forward self imgs size augment false profile false supports inference various sources height width rgb images example inputs opencv imgs imread image jpg hwc bgr rgb pil imgs image open image jpg hwc numpy imgs zeros hwc torch imgs torch zeros bchw multiple imgs image open image jpg image open image jpg list images inference various sources height width rgb images example inputs filename imgs data samples zidane jpg uri https github com ultralytics yolov releases download zidane jpg open opencv imread image jpg hwc bgr rgb pil image open image jpg hwc numpy zeros hwc torch torch zeros bchw multiple image open image jpg image open image jpg list images next self model parameters device type isinstance imgs torch tensor torch return self model imgs device type typeas augment profile inference pre process preprocess isinstance imgs list imgs imgs imgs len imgs imgs isinstance imgs list else imgs number images list images shape shape image inference shapes batch range len imgs batch size batch imgsi array imgsi numpy imgsi shape else none xnone stack ascontiguousarray transpose bhwc bchw torch numpy fromnumpy device type typeas uint
