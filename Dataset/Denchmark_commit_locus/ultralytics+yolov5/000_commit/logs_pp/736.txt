wip feature ddp fixed squashed commit following commit decbbcdaaccaebf author nano code nanocode date tue jul adding world size worldsize reduce calls torch distributed use create dataloader createdataloader commit edddcddcddcdc author yizhi chen date tue jul make sync syncbn choice commit edefecadfcbcedce merge bfbeb author yzchen date tue jul merge pull request nano code nanocode patch update train commit cdefbdabadabfeaf author nano code nanocode date tue jul update train remove redundant opt prefix commit bfbebeafbbfefacafac merge author yizhi chen date tue jul merge branch master https github com ultralytics yolov feature ddp fixed ddpfixed commit cabfebbdccaeeffcbb author yizhi chen date tue jul add device allocation loss compute commit fcfbeaeeeefcaeebd author yizhi chen date thu jul revert drop last droplast commit dabeaabccfccab merge aceb author yizhi chen date thu jul merge branch feature ddp fixed ddpfixed https github com magic frog sjtu magicfrogsjtu yolov feature ddp fixed ddpfixed commit acebebdfcbdeebcebee author yizhi chen date thu jul fix warning commit bbdbeecddfdcfbe merge baae cef author yzchen date wed jul merge pull request nano code nanocode patch add drop last droplast multi gpu commit cefcfbbfecceab author nano code nanocode date wed jul add drop last droplast multi gpu commit baaedabfdeaccdf merge ecdcc author yizhi chen date tue jul merge branch master https github com ultralytics yolov feature ddp fixed ddpfixed commit ecdcccdeddffecdfbfbd merge author yizhi chen date tue jul merge branch feature ddp fixed ddpfixed https github com magic frog sjtu magicfrogsjtu yolov feature ddp fixed ddpfixed commit dedfeeeaccccdfebaa author yizhi chen date tue jul add sync syncbn commit abadabbeacbb merge faa author yzchen date tue jul merge pull request nano code nanocode patch convert batch norm batchnorm sync batch norm syncbatchnorm commit baaacdaffbc author nano code nanocode date tue jul add cleanup process group processgroup commit aafccaebededda author nano code nanocode date tue jul remove apex parallel use torch parallel future compatibility commit ceebeaaecaddcd author nano code nanocode date tue jul convert batch norm batchnorm sync batch norm syncbatchnorm commit faaaeffdfeebecadc author yizhi chen date mon jul fix datset inconsistency problem commit ecdcdcdffccfddc author yizhi chen date mon jul add loss multiplication preserver single process singleprocess performance commit effdefabefccc merge bdeaf author yizhi chen date fri jul merge branch master https github com ultralytics yolov feature ddp fixed ddpfixed commit bbfedfeaafdebebc author yizhi chen date thu jul ddp established squashed commit following commit eabddcbdedcf merge acbdc author yizhi chen date thu jul merge branch master https github com ultralytics yolov feature ddp fixed ddpfixed commit acbdcbefcbcbbbabbd author glenn jocher date wed jul update test save txt savetxt commit bcdaadafdb author glenn jocher date wed jul update test save txt savetxt commit efcdbcebeeb author yizhi chen date wed jul revert readme removal commit cbfadcafdc merge cdb fbbb author yizhi chen date wed jul merge branch feature ddp fixed ddpfixed https github com magic frog sjtu magicfrogsjtu yolov feature ddp fixed ddpfixed commit cdbcdcdffbbbadfcece author yizhi chen date wed jul fix ddp performance deterioration bug commit fbbbfaebabbbdfbee author glenn jocher date wed jul delete readme commit fbaefbacbacf merge abf bdfdbb author yizhi chen date wed jul merge branch feature ddp fixed ddpfixed https github com magic frog sjtu magicfrogsjtu yolov feature ddp fixed ddpfixed commit bdfdbbfbefeeffacaae author glenn jocher date tue jul update readme commit caaccbaaafcaefdecec merge bfb author glenn jocher date tue jul merge branch master feature ddp fixed ddpfixed commit bfbfafdfadbda author nano code nanocode date tue jul fixed world size worldsize found called test commit abfcddabadaaacaafbdc merge cad author yizhi chen date tue jul merge branch feature ddp fixed ddpfixed https github com magic frog sjtu magicfrogsjtu yolov feature ddp fixed ddpfixed commit adeddabedfaab author yizhi chen date tue jul add assertion date tue jul merge pull request magic frog sjtu magicfrogsjtu nano code patch nanocodepatch modify number dataloaders workers commit ffefabca author nano code nanocode date tue jul fixed issue single gpu world size worldsize commit daaddfdbfebfeba author nano code nanocode date tue jul add assert message clarification clarify assertion thrown users commit deddefcedafaf author nano code nanocode date tue jul changed number workers check commit decbbcdaaccaebf author nano code nanocode date tue jul adding world size worldsize reduce calls torch distributed use create dataloader createdataloader commit edddcddcddcdc author yizhi chen date tue jul make sync syncbn choice commit edefecadfcbcedce merge bfbeb author yzchen date tue jul merge pull request nano code nanocode patch update train commit cdefbdabadabfeaf author nano code nanocode date tue jul update train remove redundant opt prefix commit bfbebeafbbfefacafac merge author yizhi chen date tue jul merge branch master https github com ultralytics yolov feature ddp fixed ddpfixed commit cabfebbdccaeeffcbb author yizhi chen date tue jul add device allocation loss compute commit fcfbeaeeeefcaeebd author yizhi chen date thu jul revert drop last droplast commit dabeaabccfccab merge aceb author yizhi chen date thu jul merge branch feature ddp fixed ddpfixed https github com magic frog sjtu magicfrogsjtu yolov feature ddp fixed ddpfixed commit acebebdfcbdeebcebee author yizhi chen date thu jul fix warning commit bbdbeecddfdcfbe merge baae cef author yzchen date wed jul merge pull request nano code nanocode patch add drop last droplast multi gpu commit cefcfbbfecceab author nano code nanocode date wed jul add drop last droplast multi gpu commit baaedabfdeaccdf merge ecdcc author yizhi chen date tue jul merge branch master https github com ultralytics yolov feature ddp fixed ddpfixed commit ecdcccdeddffecdfbfbd merge author yizhi chen date tue jul merge branch feature ddp fixed ddpfixed https github com magic frog sjtu magicfrogsjtu yolov feature ddp fixed ddpfixed commit dedfeeeaccccdfebaa author yizhi chen date tue jul add sync syncbn commit abadabbeacbb merge faa author yzchen date tue jul merge pull request nano code nanocode patch convert batch norm batchnorm sync batch norm syncbatchnorm commit baaacdaffbc author nano code nanocode date tue jul add cleanup process group processgroup commit aafccaebededda author nano code nanocode date tue jul remove apex parallel use torch parallel future compatibility commit ceebeaaecaddcd author nano code nanocode date tue jul convert batch norm batchnorm sync batch norm syncbatchnorm commit faaaeffdfeebecadc author yizhi chen date mon jul fix datset inconsistency problem commit ecdcdcdffccfddc author yizhi chen date mon jul add loss multiplication preserver single process singleprocess performance commit effdefabefccc merge bdeaf author yizhi chen date fri jul merge branch master https github com ultralytics yolov feature ddp fixed ddpfixed commit bbfedfeaafdebebc author yizhi chen date thu jul ddp established fixed destroy process group destroyprocessgroup mode update torch utils torchutils update utils revert build targets buildtargets current master update datasets fixed world size worldsize attribute found authored coauthoredby nano code nanocode authored coauthoredby glenn jocher
accumulate optimizer step optimizer zero grad zerograd ema update model ema none ema update model print mloss mloss loss items lossitems update mean losses mem torch cuda memory cached memorycached torch cuda available isavailable else epoch epochs mem mloss targets shape imgs shape pbar set description setdescription plot best fitness bestfitness best fitness bestfitness save model save opt nosave final epoch finalepoch opt evolve save open results file resultsfile create checkpoint ckpt epoch epoch best fitness bestfitness best fitness bestfitness training results trainingresults read model ema ema optimizer none final epoch finalepoch else optimizer state dict statedict save last best delete torch save ckpt last best fitness bestfitness final epoch finalepoch torch save ckpt best del ckpt first process ddp mode allowed log save checkpoints local rank localrank map ema none ema update attr updateattr model include hyp names stride final epoch finalepoch epoch epochs opt notest final epoch finalepoch calculate map results maps times test test opt data batch size batchsize total batch size totalbatchsize imgsz imgsz test imgsztest save json savejson final epoch finalepoch opt data endswith sep coco yaml model ema ema module hasattr ema ema module else ema ema single cls singlecls opt single cls singlecls dataloader testloader save dir savedir log dir logdir explicitly keep shape write open results file resultsfile write results map test losses testlosses giou obj cls len opt name opt bucket system gsutil results txt results resultss txt opt bucket opt name tensorboard writer tbwriter tags train giou loss giouloss train obj loss objloss train cls loss clsloss metrics precision metrics recall metrics map metrics val giou loss giouloss val obj loss objloss val cls loss clsloss tag zip list mloss list results tags writer tbwriter add scalar addscalar tag epoch update best map fitness array results reshape fitness fitnessi weighted combination map best fitness bestfitness best fitness bestfitness save model save opt nosave final epoch finalepoch opt evolve save open results file resultsfile create checkpoint ckpt epoch epoch best fitness bestfitness best fitness bestfitness training results trainingresults read model ema ema module hasattr ema module else ema ema optimizer none final epoch finalepoch else optimizer state dict statedict save last best delete torch save ckpt last best fitness bestfitness final epoch finalepoch torch save ckpt best del ckpt end epoch end training strip optimizers len opt name opt name isnumeric else opt name fresults flast fbest resultss txt wdir lasts wdir bests zip wdir last wdir best results txt flast fbest fresults path exists rename rename ispt endswith strip optimizer stripoptimizer ispt else none strip optimizer system gsutil weights opt bucket opt bucket ispt else none upload finish opt evolve plot results plotresults save dir savedir log dir logdir save results png print epochs completed hours epoch start epoch startepoch time time dist destroy process group destroyprocessgroup device type cpu torch cuda device count devicecount else none local rank localrank strip optimizers len opt name opt name isnumeric else opt name fresults flast fbest resultss txt wdir lasts wdir bests zip wdir last wdir best results txt flast fbest fresults path exists rename rename ispt endswith strip optimizer stripoptimizer ispt else none strip optimizer system gsutil weights opt bucket opt bucket ispt else none upload finish opt evolve plot results plotresults save results png print epochs completed hours epoch start epoch startepoch time time dist destroy process group destroyprocessgroup local rank localrank else none torch cuda empty cache emptycache return results name main check git status checkgitstatus parser argparse argument parser argumentparser parser add argument addargument cfg type str default models yolovs yaml help model yaml path parser add argument addargument data type str default data coco yaml help data yaml path parser add argument addargument hyp type str default help hyp yaml path optional parser add argument addargument epochs type int default parser add argument addargument batch size batchsize type int default parser add argument addargument batch size batchsize type int default help total batch size gpus parser add argument addargument img size imgsize nargs type int default help train test sizes parser add argument addargument rect action store true storetrue help rectangular training parser add argument addargument resume nargs const get last getlast default false
