update train forward simplification
math ceil imgs shape new shape stretched multiple gsmultiple imgs interpolate imgs size mode bilinear align corners aligncorners false autocast forward amp autocast enabled cuda forward pred model imgs loss loss loss items lossitems compute loss computeloss pred targets device model scaled batch size batchsize pred model imgs forward loss loss items lossitems compute loss computeloss pred targets device model loss scaled batch size batchsize rank loss opt world size worldsize gradient averaged devices ddp mode torch isfinite loss logger info warning non finite nonfinite loss ending training loss items lossitems return results backward scaler scale loss backward
