update ddp torch distributed run gloo backend update ddp torch distributed run add localrank remove opt local rank localrank backend gloo nccl print print debug debug getenv gloo gloo gloo cleanup fix getenv cleanup cleanup destroy try nccl return opt add local rank localrank add timeout add init method initmethod gloo move destroy move destroy move print opt rank destroy rank move destroy inside train restore destroy outside train update print opt cleanup nccl gloo second timeout update namespace printing
dataset mosaic border mosaicborder imgsz height width borders mloss torch zeros device device mean losses rank rank dataloader sampler set epoch setepoch epoch pbar enumerate dataloader logger info epoch gpu mem gpumem box obj cls total labels img size imgsize rank rank pbar tqdm pbar total progress bar optimizer zero grad zerograd imgs targets paths pbar batch
