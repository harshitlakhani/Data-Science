update caching
self batch shapes batchshapes ceil array shapes img size imgsize stride pad astype int stride check labels create datasubset createdatasubset extract bounding boxes extractboundingboxes labels loaded labelsloaded false false false number missing found empty datasubset duplicate pbar enumerate self label files labelfiles rank pbar tqdm pbar file pbar self labelsi label none shape assert shape label columns file assert negative labels file assert non normalized nonnormalized bounds coordinate labels file unique axis shape shape duplicate rows logger warning warning duplicate rows self label filesi labelfilesi duplicate rows single cls singlecls force dataset single class singleclass mode self labelsi file found create subdataset smaller dataset create datasubset createdatasubset create folder createfolder path datasubset makedirs datasubset images exclude classes excludeclasses exclude classes excludeclasses shutil copy src self img filesi imgfilesi dst datasubset images copy image open datasubset images txt write self img filesi imgfilesi extract object detection boxes second stage classifier extract bounding boxes extractboundingboxes path self img filesi imgfilesi img imread str img shape enumerate ssclassifiersggs parent parent sep sep name path exists path parent makedirs path parent make new output folder box max rectangle square pad xywhxyxy reshape ravel astype int clip clip boxes outside image clip assert imwrite imgb failure extracting classifier boxes else logger info empty labels image self img filesi imgfilesi file empty system self img filesi imgfilesi self label filesi labelfilesi remove rank pbar desc scanning labels found missing empty duplicate images cache path cachepath warning labels found see path dirname file sep help url helpurl logger info assert augment train without labels cache images memory faster training warning large datasets may exceed system ram self imgs none cache images cacheimages
