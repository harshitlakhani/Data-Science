confusion matrix initial commit add plotting matrix cpu bug fix update plot update plot update plot update plot update plot update plot update plot update plot update plot update plot update plot update plot cleanup cleanup cleanup cleanup cleanup cleanup cleanup cleanup cleanup cleanup cleanup cleanup cleanup seaborn pandas requirements txt seaborn pandas requirements txt update wandb plotting remove pandas plots plots plots plots plots initial commit add plotting matrix cpu bug fix update plot update plot update plot update plot update plot update plot update plot update plot update plot update plot update plot update plot cleanup cleanup cleanup cleanup cleanup cleanup cleanup cleanup cleanup cleanup cleanup cleanup cleanup seaborn pandas requirements txt seaborn pandas requirements txt update wandb plotting remove pandas plots plots plots plots plots cat apriori autolabels cleanup
return mpre mrec class confusion matrix confusionmatrix updated version https github com kaanakan object detection confusion matrix objectdetectionconfusionmatrix def init self conf iou thres iouthres self matrix zeros self number classes self conf conf self iou thres iouthres iou thres iouthres def process batch processbatch self detections labels return intersection union intersectionoverunion jaccard index boxes sets boxes expected format arguments detections array arrayn conf class labels array arraym class returns none updates confusion matrix accordingly detections detectionsdetections self conf classes gtclasses labels int detection classes detectionclasses detections int iou general box iou boxiou labels detections torch iou self iou thres iouthres shape matches torch cat torch stack ioux none cpu numpy shape matches matchesmatches argsort matches matchesnp unique matches return index returnindex true matches matchesmatches argsort matches matchesnp unique matches return index returnindex true else matches zeros matches shape matches transpose astype int enumerate classes gtclasses sum self matrixgc detection classesmj detectionclassesmj correct else self matrixgc self background enumerate detection classes detectionclasses self matrixself background def matrix self return self matrix def plot self save dir savedir names try import seaborn array self matrix self matrix sum reshape self normalize arrayarray nan annotate would appear fig plt figure figsize set font scale fontscale self else label size labels len names len names self apply names ticklabels heatmap array annot self annot kws annotkws size cmap blues fmt square true xticklabels names background labels else auto yticklabels names background labels else auto set facecolor setfacecolor fig axes set xlabel setxlabel true fig axes set ylabel setylabel predicted fig tight layout tightlayout fig savefig path save dir savedir confusion matrix confusionmatrix png dpi except exception pass def print self range self print join map str self matrixi plots def plot curve plotprcurve save dir savedir names fig plt subplots figsize stack axis
