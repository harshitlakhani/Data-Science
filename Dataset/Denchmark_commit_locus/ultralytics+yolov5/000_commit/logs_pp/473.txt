refactor dataloader
model torch parallel distributed data parallel distributeddataparallel model pip install torch torchvision https download pytorch org whl torch stable torchstable html dataset dataset load images labels loadimagesandlabels train path trainpath imgsz batch size batchsize augment true hyp hyp augmentation hyperparameters rect opt rect rectangular training cache images cacheimages opt cache images cacheimages single cls singlecls opt single cls singlecls stride trainloader dataloader dataset create dataloader createdataloader train path trainpath imgsz batch size batchsize opt hyp hyp augment true cache opt cache images cacheimages rect opt rect mlc concatenate dataset labels max max label class assert mlc else number workers dataloader torch utils data data loader dataloader dataset batch size batchsize batch size batchsize num workers numworkers shuffle opt rect shuffle true unless rectangular training used pin memory pinmemory true collate collatefn dataset collate collatefn testloader testloader torch utils data data loader dataloader load images labels loadimagesandlabels test path testpath imgsz test imgsztest batch size batchsize hyp hyp rect true cache images cacheimages opt cache images cacheimages single cls singlecls opt single cls singlecls stride batch size batchsize batch size batchsize num workers numworkers pin memory pinmemory true collate collatefn dataset collate collatefn testloader create dataloader createdataloader test path testpath imgsz test imgsztest batch size batchsize opt hyp hyp augment false cache opt cache images cacheimages rect true model parameters hyp cls scale coco tuned cocotuned hyp cls current dataset
