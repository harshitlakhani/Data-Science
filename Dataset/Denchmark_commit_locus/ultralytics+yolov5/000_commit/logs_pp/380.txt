add infinite data loader infinitedataloader class add infinite data loader infinitedataloader initializes first epoch saves time moved class better location
batch size batchsize min batch size batchsize len dataset min cpu count cpucount world size worldsize batch size batchsize batch size batchsize else workers number workers train sampler trainsampler torch utils data distributed distributed sampler distributedsampler dataset rank else none dataloader torch utils data data loader dataloader dataset batch size batchsize batch size batchsize num workers numworkers sampler train sampler trainsampler pin memory pinmemory true collate collatefn load images labels loadimagesandlabels collate collatefn dataloader infinite data loader infinitedataloader dataset batch size batchsize batch size batchsize num workers numworkers sampler train sampler trainsampler pin memory pinmemory true collate collatefn load images labels loadimagesandlabels collate collatefn return dataloader dataset class infinite data loader infinitedataloader torch utils data dataloader data loader dataloader dataloader reuses workers uses syntax vanilla data loader dataloader def init self args kwargs super init args kwargs object setattr self batch sampler batchsampler repeat sampler repeatsampler self batch sampler batchsampler self iterator super iter def len self return len self batch sampler batchsampler sampler def iter self range len self yield next self iterator class repeat sampler repeatsampler object sampler repeats forever args sampler sampler def init self sampler self sampler sampler def iter self true yield iter self sampler class load images loadimages inference def init self path img size imgsize str path path agnostic osagnostic
