auto anchor autoanchor implementation
def check anchors checkanchors dataset model thr imgsz check best possible recall dataset current anchors check anchor fit data recompute necessary print analyzing nanalyzing anchors end anchors model module model anchor grid anchorgrid hasattr model module else model model anchor grid anchorgrid shapes imgsz dataset shapes dataset shapes max keepdims true torch tensor concatenate zip shapes dataset labels float ratio none anchors view cpu none ratio torch max ratio ratio max max ratio bpr min best possible recall bpr threshold training cancelled compute new anchors utils utils kmeans anchors kmeansanchors update model training bpr thr float mean match ratio print best possible recall bpr bpr end bpr threshold recompute print generating new anchors improved recall please wait bpr new anchors newanchors kmean anchors kmeananchors dataset img size imgsize thr gen verbose false anchors torch tensor new anchors newanchors view viewas anchors type typeas anchors print new anchors saved model update model yaml use anchors future print newline def check file checkfile file
