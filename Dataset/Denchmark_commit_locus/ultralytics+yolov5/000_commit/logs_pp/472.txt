refactor dataloader
data yaml load loader yaml full loader fullloader model dict single cls singlecls else int data number classes iouv torch linspace device iou vector map iouv iouv view comment map niou iouv numel dataloader dataloader none training merge opt merge use merge nms img torch zeros imgsz imgsz device device init img model img half half else img device type cpu else none run merge opt merge use merge nms path data test opt task test else data val path val test images dataset load images labels loadimagesandlabels path imgsz batch size batchsize rect true rectangular inference single cls singlecls opt single cls singlecls single class mode stride int max model stride model stride pad padding batch size batchsize min batch size batchsize len dataset min cpu count cpucount batch size batchsize batch size batchsize else number workers dataloader data loader dataloader dataset batch size batchsize batch size batchsize num workers numworkers pin memory pinmemory true collate collatefn dataset collate collatefn dataloader create dataloader createdataloader path imgsz batch size batchsize int max model stride opt hyp none augment false cache false pad rect true seen names model names hasattr model names else model module names
