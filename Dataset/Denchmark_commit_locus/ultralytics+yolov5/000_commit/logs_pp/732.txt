wip feature ddp fixed squashed commit following commit decbbcdaaccaebf author nano code nanocode date tue jul adding world size worldsize reduce calls torch distributed use create dataloader createdataloader commit edddcddcddcdc author yizhi chen date tue jul make sync syncbn choice commit edefecadfcbcedce merge bfbeb author yzchen date tue jul merge pull request nano code nanocode patch update train commit cdefbdabadabfeaf author nano code nanocode date tue jul update train remove redundant opt prefix commit bfbebeafbbfefacafac merge author yizhi chen date tue jul merge branch master https github com ultralytics yolov feature ddp fixed ddpfixed commit cabfebbdccaeeffcbb author yizhi chen date tue jul add device allocation loss compute commit fcfbeaeeeefcaeebd author yizhi chen date thu jul revert drop last droplast commit dabeaabccfccab merge aceb author yizhi chen date thu jul merge branch feature ddp fixed ddpfixed https github com magic frog sjtu magicfrogsjtu yolov feature ddp fixed ddpfixed commit acebebdfcbdeebcebee author yizhi chen date thu jul fix warning commit bbdbeecddfdcfbe merge baae cef author yzchen date wed jul merge pull request nano code nanocode patch add drop last droplast multi gpu commit cefcfbbfecceab author nano code nanocode date wed jul add drop last droplast multi gpu commit baaedabfdeaccdf merge ecdcc author yizhi chen date tue jul merge branch master https github com ultralytics yolov feature ddp fixed ddpfixed commit ecdcccdeddffecdfbfbd merge author yizhi chen date tue jul merge branch feature ddp fixed ddpfixed https github com magic frog sjtu magicfrogsjtu yolov feature ddp fixed ddpfixed commit dedfeeeaccccdfebaa author yizhi chen date tue jul add sync syncbn commit abadabbeacbb merge faa author yzchen date tue jul merge pull request nano code nanocode patch convert batch norm batchnorm sync batch norm syncbatchnorm commit baaacdaffbc author nano code nanocode date tue jul add cleanup process group processgroup commit aafccaebededda author nano code nanocode date tue jul remove apex parallel use torch parallel future compatibility commit ceebeaaecaddcd author nano code nanocode date tue jul convert batch norm batchnorm sync batch norm syncbatchnorm commit faaaeffdfeebecadc author yizhi chen date mon jul fix datset inconsistency problem commit ecdcdcdffccfddc author yizhi chen date mon jul add loss multiplication preserver single process singleprocess performance commit effdefabefccc merge bdeaf author yizhi chen date fri jul merge branch master https github com ultralytics yolov feature ddp fixed ddpfixed commit bbfedfeaafdebebc author yizhi chen date thu jul ddp established squashed commit following commit eabddcbdedcf merge acbdc author yizhi chen date thu jul merge branch master https github com ultralytics yolov feature ddp fixed ddpfixed commit acbdcbefcbcbbbabbd author glenn jocher date wed jul update test save txt savetxt commit bcdaadafdb author glenn jocher date wed jul update test save txt savetxt commit efcdbcebeeb author yizhi chen date wed jul revert readme removal commit cbfadcafdc merge cdb fbbb author yizhi chen date wed jul merge branch feature ddp fixed ddpfixed https github com magic frog sjtu magicfrogsjtu yolov feature ddp fixed ddpfixed commit cdbcdcdffbbbadfcece author yizhi chen date wed jul fix ddp performance deterioration bug commit fbbbfaebabbbdfbee author glenn jocher date wed jul delete readme commit fbaefbacbacf merge abf bdfdbb author yizhi chen date wed jul merge branch feature ddp fixed ddpfixed https github com magic frog sjtu magicfrogsjtu yolov feature ddp fixed ddpfixed commit bdfdbbfbefeeffacaae author glenn jocher date tue jul update readme commit caaccbaaafcaefdecec merge bfb author glenn jocher date tue jul merge branch master feature ddp fixed ddpfixed commit bfbfafdfadbda author nano code nanocode date tue jul fixed world size worldsize found called test commit abfcddabadaaacaafbdc merge cad author yizhi chen date tue jul merge branch feature ddp fixed ddpfixed https github com magic frog sjtu magicfrogsjtu yolov feature ddp fixed ddpfixed commit adeddabedfaab author yizhi chen date tue jul add assertion date tue jul merge pull request magic frog sjtu magicfrogsjtu nano code patch nanocodepatch modify number dataloaders workers commit ffefabca author nano code nanocode date tue jul fixed issue single gpu world size worldsize commit daaddfdbfebfeba author nano code nanocode date tue jul add assert message clarification clarify assertion thrown users commit deddefcedafaf author nano code nanocode date tue jul changed number workers check commit decbbcdaaccaebf author nano code nanocode date tue jul adding world size worldsize reduce calls torch distributed use create dataloader createdataloader commit edddcddcddcdc author yizhi chen date tue jul make sync syncbn choice commit edefecadfcbcedce merge bfbeb author yzchen date tue jul merge pull request nano code nanocode patch update train commit cdefbdabadabfeaf author nano code nanocode date tue jul update train remove redundant opt prefix commit bfbebeafbbfefacafac merge author yizhi chen date tue jul merge branch master https github com ultralytics yolov feature ddp fixed ddpfixed commit cabfebbdccaeeffcbb author yizhi chen date tue jul add device allocation loss compute commit fcfbeaeeeefcaeebd author yizhi chen date thu jul revert drop last droplast commit dabeaabccfccab merge aceb author yizhi chen date thu jul merge branch feature ddp fixed ddpfixed https github com magic frog sjtu magicfrogsjtu yolov feature ddp fixed ddpfixed commit acebebdfcbdeebcebee author yizhi chen date thu jul fix warning commit bbdbeecddfdcfbe merge baae cef author yzchen date wed jul merge pull request nano code nanocode patch add drop last droplast multi gpu commit cefcfbbfecceab author nano code nanocode date wed jul add drop last droplast multi gpu commit baaedabfdeaccdf merge ecdcc author yizhi chen date tue jul merge branch master https github com ultralytics yolov feature ddp fixed ddpfixed commit ecdcccdeddffecdfbfbd merge author yizhi chen date tue jul merge branch feature ddp fixed ddpfixed https github com magic frog sjtu magicfrogsjtu yolov feature ddp fixed ddpfixed commit dedfeeeaccccdfebaa author yizhi chen date tue jul add sync syncbn commit abadabbeacbb merge faa author yzchen date tue jul merge pull request nano code nanocode patch convert batch norm batchnorm sync batch norm syncbatchnorm commit baaacdaffbc author nano code nanocode date tue jul add cleanup process group processgroup commit aafccaebededda author nano code nanocode date tue jul remove apex parallel use torch parallel future compatibility commit ceebeaaecaddcd author nano code nanocode date tue jul convert batch norm batchnorm sync batch norm syncbatchnorm commit faaaeffdfeebecadc author yizhi chen date mon jul fix datset inconsistency problem commit ecdcdcdffccfddc author yizhi chen date mon jul add loss multiplication preserver single process singleprocess performance commit effdefabefccc merge bdeaf author yizhi chen date fri jul merge branch master https github com ultralytics yolov feature ddp fixed ddpfixed commit bbfedfeaafdebebc author yizhi chen date thu jul ddp established fixed destroy process group destroyprocessgroup mode update torch utils torchutils update utils revert build targets buildtargets current master update datasets fixed world size worldsize attribute found authored coauthoredby nano code nanocode authored coauthoredby glenn jocher
mixed precision mixedprecision model optimizer amp initialize model optimizer opt level optlevel verbosity distributed training device type cpu torch cuda device count devicecount dist available isavailable dist init process group initprocessgroup backend nccl distributed backend init method initmethod tcp init method world size worldsize number nodes rank node rank model torch sync batch norm syncbatchnorm convert sync batchnorm convertsyncbatchnorm model device requires world size worldsize model torch parallel distributed data parallel distributeddataparallel model scheduler https arxiv org pdf pdf lambda math cos math epochs cosine scheduler scheduler lrscheduler lambda lambdalr optimizer lambda lrlambda https discuss pytorch org problem occured resuming optimizer aproblemoccuredwhenresuminganoptimizer plot scheduler plotlrscheduler optimizer scheduler epochs mode device type cpu local rank localrank torch cuda device count devicecount model torch data parallel dataparallel model exponential moving average https github com rwightman pytorch image models pytorchimagemodels blob master train important create ema model cuda wrapper amp sync syncbn ddp wrapper chenyzsjtu ema placed sync syncbn sync syncbn introduces new modules opt sync syncbn device type cpu local rank localrank print sync syncbn activated model torch sync batch norm syncbatchnorm convert sync batchnorm convertsyncbatchnorm model device ema torch utils torchutils model ema modelema model local rank localrank else none ddp mode device type cpu local rank localrank model ddp model device ids deviceids local rank localrank output device outputdevice local rank localrank trainloader dataloader dataset create dataloader createdataloader train path trainpath imgsz batch size batchsize opt hyp hyp augment true cache opt cache images cacheimages rect opt rect dataloader dataset create dataloader createdataloader train path trainpath imgsz batch size batchsize opt hyp hyp augment true cache opt cache images cacheimages rect opt rect local rank localrank local rank localrank world size worldsize opt world size worldsize mlc concatenate dataset labels max max label class len dataloader number batches assert mlc label class exceeds possible class labels mlc opt data testloader testloader create dataloader createdataloader test path testpath imgsz test imgsztest batch size batchsize opt hyp hyp augment false cache opt cache images cacheimages rect true local rank localrank local rank localrank set first process expected evaluation testloader create dataloader createdataloader test path testpath imgsz test imgsztest total batch size totalbatchsize opt hyp hyp augment false cache opt cache images cacheimages rect true local rank localrank world size worldsize opt world size worldsize model parameters hyp cls scale coco tuned cocotuned hyp cls current dataset
