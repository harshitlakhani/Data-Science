add train run method update train explicit arguments update train add run method
torch distributed zero first torchdistributedzerofirst rank weights attempt download attemptdownload weights download found locally ckpt torch load weights map location maplocation device load checkpoint model model opt cfg ckpt model yaml anchors hyp get anchors device create exclude anchor opt cfg hyp get anchors opt resume else exclude keys model model cfg ckpt model yaml anchors hyp get anchors device create exclude anchor cfg hyp get anchors resume else exclude keys state dict statedict ckpt model float state dict statedict state dict statedict intersect dicts intersectdicts state dict statedict model state dict statedict exclude exclude intersect model load state dict loadstatedict state dict statedict strict false load logger info transferred items len state dict statedict len model state dict statedict weights report else model model opt cfg anchors hyp get anchors device create model model cfg anchors hyp get anchors device create torch distributed zero first torchdistributedzerofirst rank check dataset checkdataset data dict datadict check train path trainpath data dict datadict train
