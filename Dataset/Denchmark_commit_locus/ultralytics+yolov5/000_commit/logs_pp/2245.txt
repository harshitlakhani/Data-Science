torch pytorch update native amp torch pytorch automatic mixed precision amp training fixed problem inconsistent code length indentation fixed problem inconsistent code length indentation mixed precision training turned default
math ceil imgs shape new shape stretched multiple gsmultiple imgs interpolate imgs size mode bilinear align corners aligncorners false forward pred model imgs autocast amp autocast forward pred model imgs loss loss loss items lossitems compute loss computeloss pred targets device model scaled batch size batchsize rank loss opt world size worldsize gradient averaged devices ddp mode torch isfinite loss print warning non finite nonfinite loss ending training loss items lossitems return results loss loss loss items lossitems compute loss computeloss pred targets device model scaled batch size batchsize rank loss opt world size worldsize gradient averaged devices ddp mode torch isfinite loss print warning non finite nonfinite loss ending training loss items lossitems return results backward mixed precision mixedprecision amp scale loss scaleloss loss optimizer scaled loss scaledloss scaled loss scaledloss backward else loss backward scaler scale loss backward optimize accumulate optimizer step scaler step optimizer optimizer step scaler update optimizer zero grad zerograd ema none ema update model
