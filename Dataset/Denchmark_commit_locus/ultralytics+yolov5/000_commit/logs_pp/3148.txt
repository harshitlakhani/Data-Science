utils reorganization utils reorganization add new utils files cleanup simplify reduce datasets remove evolve load webcam loadwebcam cleanup
boxes clamp img shape imgshape def per class apperclass conf pred cls predcls target cls targetcls plot false fname precision recall curve precisionrecallcurve png compute average precision given recall precision curves source https github com rafaelpadilla object detection metrics objectdetectionmetrics arguments true positives nparray conf objectness value nparray pred cls predcls predicted object classes nparray target cls targetcls true object classes nparray plot plot precision recall precisionrecall curve map fname plot filename returns average precision computed faster rcnn pyfasterrcnn sort objectness argsort conf conf pred cls predcls tpi confi pred clsi predclsi find unique classes unique classes uniqueclasses unique target cls targetcls create precision recall precisionrecall curve compute class linspace plotting score prscore score evaluate https github com ultralytics yolov issues unique classes uniqueclasses shape shape number class number iou thresholds map zeros zeros zeros enumerate unique classes uniqueclasses pred cls predcls target cls targetcls sum number labels sum number predictions continue else accumulate fps tps fpc tpi cumsum tpc tpi cumsum recall recall tpc recall curve rci interp score prscore confi recall score prscore negative decreases precision precision tpc tpc fpc precision curve pci interp score prscore confi precision score prscore recall precision recallprecision curve range shape apci mpre mrec compute computeap recall precision append interp mrec mpre precision map compute score harmonic mean precision recall plot stack axis fig plt subplots figsize plot linewidth color grey plot recall precision plot mean linewidth color blue label classes map mean set xlabel setxlabel recall set ylabel setylabel precision set xlim setxlim set ylim setylim plt legend fig tight layout tightlayout fig savefig fname dpi return unique classes uniqueclasses astype int def compute computeap recall precision compute average precision given recall precision curves source https github com rbgirshick faster rcnn pyfasterrcnn arguments recall recall curve list precision precision curve list returns average precision computed faster rcnn pyfasterrcnn append sentinel values beginning end mrec recall concatenate recall recall mpre precision concatenate precision compute precision envelope mpre flip maximum accumulate flip mpre integrate area curve method interp methods continuous interp method interp linspace point interp coco trapz interp mrec mpre integrate else continuous mrec mrec points axis recall changes sum mreci mreci mprei area curve return mpre mrec def bbox iou bboxiou box box xyxy true giou false diou false ciou false eps returns iou box box box box box box
