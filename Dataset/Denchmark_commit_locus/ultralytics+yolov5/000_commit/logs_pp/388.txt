initial commit
models common import class sum module weighted sum layers https arxiv org abs def init self weight false number inputs super sum self init self weight weight apply weights boolean self iter range iter object weight self parameter torch arange requires grad requiresgrad true layer weights def forward self weight self weight torch sigmoid self self iter else self iter return class ghost conv ghostconv module def init self act true chin chout kernel stride groups super ghost conv ghostconv self init hidden channels self conv act self conv act def forward self self return torch cat self class ghost bottleneck ghostbottleneck module def init self super ghost bottleneck ghostbottleneck self init self conv sequential ghost conv ghostconv conv dwconv act false else identity ghost conv ghostconv act false linear pwlinear self shortcut sequential conv dwconv act false conv act false else identity def forward self return self conv self shortcut
