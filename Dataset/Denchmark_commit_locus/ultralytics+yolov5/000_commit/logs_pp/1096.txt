auto anchor autoanchor implementation
usage utils utils import kmean anchors kmeananchors thr thr def metric compute metrics none none knone torch min min ratio metric iou whiou torch tensor iou metric return max best bestx utils datasets import load images labels loadimagesandlabels def fitness mutation fitness best metric return best best thr float mean fitness def print results printresults knp argsort prod sort small large iou iou whiou torch tensor max iou maxiou iou max bpr aat max iou maxiou thr float mean iou thr float mean best possible recall anch thr thr none none knone torch max max max maxar min bpr aat max maxar thr print iou thr iouthr best possible recall anchors thr thr bpr aat print img size imgsize iouall mean fmean best iou thr mean fmean img size imgsize iou mean max iou maxiou mean iouiou thr mean end best metric bpr aat best thr float mean thr float mean best possible recall anch thr print thr best possible recall anchors past thr thr bpr aat print img size imgsize metric metricall mean fmean best past thr pastthr mean fmean img size imgsize mean best mean thr mean end enumerate print round round end thr float mean product def fitness ratio fitnessratio mutation fitness none none knone torch max max min return remove threshold boxes numpy filter pixels kmeans calculation scipy cluster import kmeans
