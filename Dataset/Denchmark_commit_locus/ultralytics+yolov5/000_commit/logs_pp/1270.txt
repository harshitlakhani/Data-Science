opt img weights imgweights bug fix
model train update image weights optional dataset image weights imageweights opt img weights imgweights generate indices rank model class weights classweights cpu numpy maps class weights image weights imageweights labels image weights labelstoimageweights dataset labels class weights classweights dataset indices random choices range dataset weights image weights imageweights dataset rand weighted idx model class weights classweights cpu numpy maps class weights labels image weights labelstoimageweights dataset labels class weights classweights image weights dataset indices random choices range dataset weights dataset rand weighted idx broadcast ddp rank indices torch zeros dataset dtype torch int rank indices torch tensor dataset indices dtype torch int indices torch tensor dataset indices rank else torch zeros dataset int dist broadcast indices rank dataset indices indices cpu numpy
