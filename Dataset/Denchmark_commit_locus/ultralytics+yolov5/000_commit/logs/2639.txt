      EMA bug fix #279 
     """        def __init__(self, model, decay=0.9999, device=''):         # make a copy of the model for accumulating moving average of weights         self.ema = deepcopy(model)         # Create EMA         self.ema = deepcopy(model.module if is_parallel(model) else model).half()  # FP16 EMA          self.ema.eval()          self.updates = 0  # number of EMA updates          self.decay = lambda x: decay * (1 - math.exp(-x / 2000))  # decay exponential ramp (to help early epochs) 
