      AutoAnchor update - improvement check 
     """      thr = 1. / thr       def metric(k):  # compute metrics     def metric(k, wh):  # compute metrics          r = wh[:, None] / k[None]          x = torch.min(r, 1. / r).min(2)[0]  # ratio metric          # x = wh_iou(wh, torch.tensor(k))  # iou metric          return x, x.max(1)[0]  # x, best_x        def fitness(k):  # mutation fitness         _, best = metric(torch.tensor(k, dtype=torch.float32))         _, best = metric(torch.tensor(k, dtype=torch.float32), wh)          return (best * (best > thr).float()).mean()  # fitness        def print_results(k):          k = k[np.argsort(k.prod(1))]  # sort small to large         x, best = metric(k)         x, best = metric(k, wh0)          bpr, aat = (best > thr).float().mean(), (x > thr).float().mean() * n  # best possible recall, anch > thr          print('thr=%.2f: %.3f best possible recall, %.2f anchors past thr' % (thr, bpr, aat))          print('n=%g, img_size=%s, metric_all=%.3f/%.3f-mean/best, past_thr=%.3f-mean: ' % 
