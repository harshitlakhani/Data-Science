      Update utils.py 
             lbox += (1.0 - giou).sum() if red == 'sum' else (1.0 - giou).mean()  # giou loss                # Obj             tobj[b, a, gj, gi] = (1.0 - model.gr) + model.gr * giou.detach().clamp(0).type(tobj.dtype)  # giou ratio             tobj[b, a, gj, gi] = (1.0 - gr) + gr * giou.detach().clamp(0).type(tobj.dtype)  # giou ratio                # Class             if model.nc > 1:  # cls loss (only if multiple classes)             if nc > 1:  # cls loss (only if multiple classes)                  t = torch.full_like(ps[:, 5:], cn)  # targets                  t[range(nb), tcls[i]] = cp                  lcls += BCEcls(ps[:, 5:], t)  # BCE 
