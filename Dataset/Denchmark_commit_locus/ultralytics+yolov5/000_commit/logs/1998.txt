      TensorBoard DP/DDP graph fix (#3325) 
     def is_parallel(model):     # Returns True if model is of type DP or DDP      return type(model) in (nn.parallel.DataParallel, nn.parallel.DistributedDataParallel)     def de_parallel(model):     # De-parallelize a model: returns single-GPU model if model is of type DP or DDP     return model.module if is_parallel(model) else model    def intersect_dicts(da, db, exclude=()):      # Dictionary intersection of matching keys and shapes, omitting 'exclude' keys, using da values      return {k: v for k, v in da.items() if k in db and not any(x in k for x in exclude) and v.shape == db[k].shape} 
