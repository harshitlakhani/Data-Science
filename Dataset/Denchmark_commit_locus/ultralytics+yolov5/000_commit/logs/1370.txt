      Improved model+EMA checkpointing 2 (#2295) 
 import os  import random  import time from copy import deepcopy  from pathlib import Path  from threading import Thread   
