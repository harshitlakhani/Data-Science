      Improved model+EMA checkpointing (#2292)          * Enhanced model+EMA checkpointing          * update          * bug fix          * bug fix 2          * always save optimizer          * ema half          * remove model.float()          * model half          * carry ema/model in fp32          * rm model.float()          * both to float always          * cleanup          * cleanup 
         # DDP process 0 or single-GPU          if rank in [-1, 0]:              # mAP             if ema:                 ema.update_attr(model, include=['yaml', 'nc', 'hyp', 'gr', 'names', 'stride', 'class_weights'])             ema.update_attr(model, include=['yaml', 'nc', 'hyp', 'gr', 'names', 'stride', 'class_weights'])              final_epoch = epoch + 1 == epochs              if not opt.notest or final_epoch:  # Calculate mAP                  results, maps, times = test.test(opt.data, 
