      updates 
         save = (not opt.nosave) or (final_epoch and not opt.evolve)          if save:              with open(results_file, 'r') as f:  # create checkpoint                 chkpt = {'epoch': epoch,                 ckpt = {'epoch': epoch,                           'best_fitness': best_fitness,                           'training_results': f.read(),                           'model': ema.ema.module if hasattr(model, 'module') else ema.ema,                           'optimizer': None if final_epoch else optimizer.state_dict()}                # Save last, best and delete             torch.save(chkpt, last)             torch.save(ckpt, last)              if (best_fitness == fi) and not final_epoch:                 torch.save(chkpt, best)             del chkpt                 torch.save(ckpt, best)             del ckpt            # end epoch ----------------------------------------------------------------------------------------------------      # end training 
